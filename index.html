<head>
    <link href="https://vjs.zencdn.net/8.4.2/video-js.css" rel="stylesheet" />
    <link href="./chapter.css" rel="stylesheet"/>
    <script src="https://vjs.zencdn.net/8.4.2/video.js"></script> 
    <script type="module" src="./components/markers.js"></script>
    <script type="module" src="./components/marker.js"></script>
    <script type="module" src="./components/mousedisplay.js"></script>
    <script type="module" src="./components/time-tooltip.js"></script>

    <script type="module" src="./chapter-plugin.js"></script>
  </head>
  
  <body>
    <video id="player" class="video-js vjs-has-started" controls muted></video>
    <script type="module">
      const player = videojs('player', {
        fill: true,
      });
  
      player.src({
        src: 'https://d2zihajmogu5jn.cloudfront.net/bipbop-advanced/bipbop_16x9_variant.m3u8',
        type: 'application/x-mpegURL'
      });

      player.chapter({
        markers:[
            { startTime: 69, label: 'Marker st 69' },
            { startTime: 420, label: 'Marker st 420' },
            { startTime: 700.35, label: 'Marker st 700.35' },
            { startTime: 1069, label: 'Marker st 1069' },
            { startTime: 1337, label: 'Marker st 1337' }
        ]
      })

    /*player.addClass('chapter-markers');
    
    function addMarkers(markers = []) {
        if (!markers.length) return;
         
        console.log('inside addMarkers')
    
        const markersTrack = player.addTextTrack(
          'metadata',
          'chapter-markers',
          player.language()
        );
    
        markers.forEach((marker, index, arr) => {
          const nextMarkerIndex = index + 1;
          const nextMarker = arr[nextMarkerIndex];
          const { startTime } = marker;
          const endTime = nextMarker ? nextMarker.startTime : player.duration();
          const cue = {
            startTime,
            endTime,
            text: JSON.stringify(marker),
          };
    
          markersTrack.addCue(cue);
        });
      })


    function loadedMetadata() {
        console.log('inside loadedMetadata')
        const markers= [
          { startTime: 69, label: 'Marker st 69' },
          { startTime: 420, label: 'Marker st 420' },
          { startTime: 700.35, label: 'Marker st 700.35' },
          { startTime: 1069, label: 'Marker st 1069' },
          { startTime: 1337, label: 'Marker st 1337' },
          { startTime: 1420.69, label: 'Marker st 1420.69' },
        ]
        addMarkers(markers);
      }

    player.on('loadedmetadata', loadedMetadata);


    player
    .getChild('ControlBar')
    .getChild('progressControl')
    .getChild('seekBar')
    .addChild('MarkersDisplay',{ 
        componentClass: 'MarkersDisplay',
    })*/
    </script>
  </body>